<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tenshi | 幻想の響き</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    :root { --ang: 0; --angVid: 0; }

    body {
      font-family: 'Helvetica Neue', sans-serif;
      background: #0b0b0b; color: #f5f5f5;
      overflow-x: hidden; width: 100%; height: 100%;
      transition: background .3s, color .3s;
    }
    body.light-mode { background: #f5f5f5; color: #111; }

    @keyframes shake {
      0% { transform: translateX(0) scale(1.15); }
      2% { transform: translateX(-.5px) rotate(-.5deg) scale(1.16); }
      5% { transform: translateX(.5px) rotate(.5deg) scale(1.15); }
      7% { transform: translateX(-.5px) rotate(-.5deg) scale(1.16); }
      100% { transform: translateX(0) rotate(0) scale(1.15); }
    }

    header {
      position: fixed; top: 0; width: 100%;
      background: rgba(0,0,0,.8);
      padding: 20px 5%;
      display: flex; justify-content: space-between; align-items: center;
      z-index: 999; backdrop-filter: blur(10px);
    }
    header .logo { color: #fff; font-size: 20px; letter-spacing: 2px; }
    nav ul { display: flex; gap: 25px; list-style: none; }
    nav a { color: #ccc; text-decoration: none; font-size: 14px; transition: all .3s ease; display: inline-block; }
    nav a:hover { color: #e0c27b; animation: shake .2s ease-in-out infinite alternate; }

    .theme-toggle {
      background: none; border: 1px solid #777; color: #ccc;
      padding: 6px 12px; border-radius: 8px; cursor: pointer; transition: all .3s; font-size: 12px; margin-left: 20px;
    }
    .theme-toggle:hover { background: #e0c27b; color: #000; }

    /* ====== HERO (banner principal) ====== */
    .hero-wrapper { position: relative; height: 70vh; overflow: hidden; margin-top: 70px; }
    .hero-bg { position: absolute; inset: 0; width: 100%; height: 100%; background: #0b0b0b; z-index: 0; }
    .hero-text {
      position: relative; z-index: 2; color: #fff; font-size: 2rem;
      padding: 60px 5%; height: 100%; display: flex; align-items: center;
      text-shadow: 0 2px 10px rgba(0,0,0,.6);
    }

    /* Reproductores fondo “limpios” */
    .bg-video, .bg-iframe { position:absolute; inset:0; width:100%; height:100%; object-fit:cover; border:0; }
    .bg-iframe { pointer-events:none; transform:scale(1.2); transform-origin:center; }
    .hero-wrapper::after{
      content:""; position:absolute; inset:0;
      background:linear-gradient(180deg,#0006,#0000 40%,#0006);
      pointer-events:none;
    }

    .contenedor-centrado{ display:flex; flex-direction:column; align-items:center; padding:20px 0; margin-top:20px; }
    .social-bar{ display:flex; justify-content:center; gap:30px; margin:20px 0; width:100%; max-width:800px; }
    .social-bar a{ display:inline-block; transition: transform .3s ease, fill .3s ease; }
    .social-bar svg{ width:36px; height:36px; fill:#888; }
    .social-bar a:hover svg{ fill:#e0c27b; transform:scale(1.15); }
    .music-platforms{ gap:20px; }
    .music-platforms a{ font-size:40px; }
    .social-networks{ gap:15px; margin-top:10px; }
    .social-networks a{ font-size:32px; }

    /* ====== NEWS ====== */
    .news{
      padding: 100px 5% 80px; background:#1a1a1a;
      max-width: 1200px; margin: -50px auto 80px; border-radius: 12px;
      box-shadow: 0 0 30px rgba(0,0,0,.3); transition: background .3s ease;
    }
    .news h2{ font-size: 32px; color:#fff; margin-bottom:30px; text-align:center; }
    .news h2 span{ font-size:14px; color:#ccc; margin-left:10px; }
    .schedule-filters{ margin-bottom: 40px; display:flex; justify-content:center; gap:20px; }
    .schedule-filters button{
      background:none; border:1px solid #555; color:#ccc; padding:8px 18px; font-size:14px;
      cursor:pointer; border-radius:20px; transition:all .3s ease;
    }
    .schedule-filters button.active, .schedule-filters button:hover{ color:#e0c27b; border-color:#e0c27b; }

    .schedule-grid{
      display:grid; grid-template-columns: 2fr 1fr 1fr; grid-template-rows: 1fr 1fr;
      gap:20px; max-width:1200px; margin:0 auto;
    }

    .main-news, .news-card{
      position:relative; display:block; text-decoration:none; color:inherit;
      overflow:hidden; padding:0; border-radius:16px;
    }
    .main-news{
      grid-column:1/2; grid-row:1/3;
      background:linear-gradient(135deg,#4c51bf,#4c51bf);
      box-shadow:0 0 20px rgba(76,81,191,.8); aspect-ratio:1/1;
    }
    .news-card{ background:#222; box-shadow:0 0 15px rgba(0,0,0,.5); aspect-ratio:1/1; cursor:pointer; transition:transform .3s ease; }
    .news-card:hover{ transform:scale(1.05); animation:shake .2s ease-in-out infinite alternate; }

    .main-news img, .news-card img{
      position:absolute; inset:10px; width:calc(100% - 20px); height:calc(100% - 20px);
      object-fit:cover; border-radius:10px; display:block;
    }

    /* ====== SECTION BANNERS (con título centrado) ====== */
    .section-banner{
      position:relative; width:100%; height:300px; margin:60px auto; border-radius:12px;
      background:#111; overflow:hidden;
      box-shadow:0 0 20px rgba(0,0,0,.5);
      display:flex; align-items:center; justify-content:center;
    }
    .section-banner::after{
      content:""; position:absolute; inset:0;
      background:linear-gradient(180deg,#0007,#0002 50%,#0007);
      pointer-events:none;
    }
    .banner-content{
      position:relative; z-index:3; text-align:center; user-select:none;
      text-shadow:0 6px 18px rgba(0,0,0,.55);
    }
    .banner-title{
      font-size:56px; font-weight:900; letter-spacing:1px;
    }
    .banner-sub{
      margin-top:10px; font-size:14px; opacity:.9;
    }

    /* ====== DISCOGRAFÍA (3D) ====== */
    .discography{ display:flex; flex-direction:column; align-items:center; justify-content:center; padding:80px 0; }
    .container{ display:flex; align-items:center; justify-content:center; position:relative; }

    .discography .holder{ width:600px; height:200px; display:flex; justify-content:center; align-items:center; perspective:700px; perspective-origin:center; position:relative; z-index:1; }
    .discography .spinner{ transform-style:preserve-3d; position:relative; display:flex; align-items:center; justify-content:center; transform: rotateY(calc(var(--ang) * 1deg)) translateY(-12px); transition: all .5s ease-in-out; }
    .discography .panel{
      border-radius:10px; width:120px; height:120px; position:absolute; background-size:cover; background-position:50% 50%;
      box-shadow:0 10px 30px rgba(0,0,0,.6); opacity:1; transition: all .5s ease-in-out, opacity .2s ease-out;
    }

    .discography .panel:nth-child(1)  { transform: rotateY(0deg) translateZ(400px); }
    .discography .panel:nth-child(2)  { transform: rotateY(24deg) translateZ(400px); }
    .discography .panel:nth-child(3)  { transform: rotateY(48deg) translateZ(400px); }
    .discography .panel:nth-child(4)  { transform: rotateY(72deg) translateZ(400px); }
    .discography .panel:nth-child(5)  { transform: rotateY(96deg) translateZ(400px); }
    .discography .panel:nth-child(6)  { transform: rotateY(120deg) translateZ(400px); }
    .discography .panel:nth-child(7)  { transform: rotateY(144deg) translateZ(400px); }
    .discography .panel:nth-child(8)  { transform: rotateY(168deg) translateZ(400px); }
    .discography .panel:nth-child(9)  { transform: rotateY(192deg) translateZ(400px); }
    .discography .panel:nth-child(10) { transform: rotateY(216deg) translateZ(400px); }
    .discography .panel:nth-child(11) { transform: rotateY(240deg) translateZ(400px); }
    .discography .panel:nth-child(12) { transform: rotateY(264deg) translateZ(400px); }
    .discography .panel:nth-child(13) { transform: rotateY(288deg) translateZ(400px); }
    .discography .panel:nth-child(14) { transform: rotateY(312deg) translateZ(400px); }
    .discography .panel:nth-child(15) { transform: rotateY(336deg) translateZ(400px); }

    .discography .fade{
      background:linear-gradient(90deg, rgba(0,0,0,0) 0%, rgba(0,0,0,.4) 30%, rgba(0,0,0,.4) 70%, rgba(0,0,0,0) 100%);
      width:860px; height:200px; position:absolute; transform: rotateY(calc(var(--ang) * -1deg)) translateZ(110px);
      transition: all .5s ease-in-out; pointer-events:none; z-index:2;
    }

    .discography .pagination{ position:absolute; top:50%; left:0; right:0; z-index:3; width:100%; display:flex; justify-content:space-between; align-items:center; transform:translateY(-50%); }
    #prev{ margin-left:20px; } #next{ margin-right:20px; }

    .discography .pagination button{
      padding:0; border:none; cursor:pointer; width:44px; height:44px; margin:0 10px;
      font-family:'Roboto', sans-serif; font-size:20px; color:black; background:#fffa; border-radius:100%; transition: all .2s ease-in-out;
    }
    .discography .pagination button:hover{ background:#fffc; }
    .discography .pagination button:active{ background:#ffff; }

    /* Fallback portadas demo */
    .discography .a{ background-image:url(https://images.unsplash.com/photo-1516727003284-a96541e51e9c?auto=format&q=85); }
    .discography .b{ background-image:url(https://images.unsplash.com/photo-1691389694412-266f872999c6?auto=format&q=85); }
    .discography .c{ background-image:url(https://images.unsplash.com/photo-1606391901318-07003db08d63?auto=format&q=85); }
    .discography .d{ background-image:url(https://images.unsplash.com/photo-1610785396756-24bd1889ddae?auto=format&q=85); }
    .discography .e{ background-image:url(https://images.unsplash.com/photo-1505849871170-7f94cf84f4d2?auto=format&q=85); }

    /* ====== VIDEOS (carrusel 3D) ====== */
    .videos{ display:flex; flex-direction:column; align-items:center; padding:80px 0; }
    .videos-holder{ width:900px; height:320px; display:flex; justify-content:center; align-items:center; perspective:1000px; perspective-origin:center; position:relative; z-index:1; }
    .spinner-videos{ transform-style:preserve-3d; position:relative; display:flex; align-items:center; justify-content:center; transform: rotateY(calc(var(--angVid) * 1deg)); transition: all .6s ease-in-out; }

    .video-panel{
      position:absolute; background:#000; border-radius:12px; overflow:hidden;
      box-shadow:0 15px 40px rgba(0,0,0,.5); transition:all .5s ease-in-out;
      width:260px; height:146px; opacity:0; pointer-events:none; transform:scale(.8);
    }
    .video-panel.center{ width:300px; height:190px; z-index:3; transform:scale(1); }
    .video-panel iframe{ width:100%; height:100%; border:0; }

    .video-panel:nth-child(1){ transform:rotateY(0deg) translateZ(400px); }
    .video-panel:nth-child(2){ transform:rotateY(40deg) translateZ(400px); }
    .video-panel:nth-child(3){ transform:rotateY(80deg) translateZ(400px); }
    .video-panel:nth-child(4){ transform:rotateY(120deg) translateZ(400px); }
    .video-panel:nth-child(5){ transform:rotateY(160deg) translateZ(400px); }
    .video-panel:nth-child(6){ transform:rotateY(200deg) translateZ(400px); }
    .video-panel:nth-child(7){ transform:rotateY(240deg) translateZ(400px); }
    .video-panel:nth-child(8){ transform:rotateY(280deg) translateZ(400px); }
    .video-panel:nth-child(9){ transform:rotateY(320deg) translateZ(400px); }

    .videos-pagination{
      position:absolute; top:50%; left:0; right:0; display:flex; justify-content:space-between;
      transform:translateY(-50%); pointer-events:none; z-index:5; padding:0 10px;
    }
    .videos-pagination button{
      pointer-events:auto; width:44px; height:44px; border-radius:50%;
      border:none; background:#fff8; color:#000; font-size:20px; cursor:pointer; transition:all .2s ease-in-out;
    }
    .videos-pagination button:hover{ background:#fff; }

    @media (max-width: 1400px){ .videos-holder{ width:860px; } }
    @media (max-width: 1200px){ .videos-holder{ width:760px; } }
    @media (max-width: 900px){
      .videos-holder{ width:100%; height:280px; }
      .video-panel{ width:200px; height:112px; }
      .video-panel.center{ width:320px; height:180px; }
    }
    @media (max-width: 600px){
      .videos-holder{ width:100%; height:240px; }
      .video-panel{ width:160px; height:90px; }
      .video-panel.center{ width:260px; height:146px; }
    }

    footer{ padding:100px 0 50px; text-align:center; color:#ccc; letter-spacing:1px; }
  </style>
</head>

<body>
  <header>
    <div class="logo">Tenshi</div>
    <nav>
      <ul>
        <li><a href="news.html">News</a></li>
        <li><a href="Discography.html" id="link-discography">Discography</a></li>
        <li><a href="movie.html">Videos</a></li>
        <li><a href="wallpapers.html">Gallery</a></li>
        <li><a href="My Studio.html">My Studio</a></li>
      </ul>
    </nav>
    <button class="theme-toggle" onclick="toggleTheme()">Modo Claro / Oscuro</button>
  </header>

  <!-- HERO -->
  <div class="hero-wrapper">
    <div class="hero-bg" id="hero-bg"></div>
    <div class="hero-text">Bienvenido a Tenshi | 幻想の響き</div>
  </div>

  <div class="contenedor-centrado">
    <div class="social-bar music-platforms">
      <a href="https://open.spotify.com" target="_blank" rel="noopener noreferrer" style="color:#1DB954;"><i class="fab fa-spotify"></i></a>
      <a href="https://music.apple.com" target="_blank" rel="noopener noreferrer" style="color:#FA57C1;"><i class="fab fa-apple"></i></a>
      <a href="https://www.youtube.com" target="_blank" rel="noopener noreferrer" style="color:#FF0000;"><i class="fab fa-youtube"></i></a>
      <a href="https://www.deezer.com" target="_blank" rel="noopener noreferrer" style="color:#FF0000;"><i class="fab fa-deezer"></i></a>
      <a href="https://music.amazon.com" target="_blank" rel="noopener noreferrer" style="color:#FF9900;"><i class="fab fa-amazon"></i></a>
      <a href="https://tidal.com" target="_blank" rel="noopener noreferrer" style="color:#000000;"><i class="fab fa-tidal"></i></a>
    </div>
    <div class="social-bar social-networks">
      <a href="https://www.instagram.com" target="_blank" rel="noopener noreferrer" style="color:#E1306C;"><i class="fab fa-instagram"></i></a>
      <a href="https://www.facebook.com" target="_blank" rel="noopener noreferrer" style="color:#1877F2;"><i class="fab fa-facebook"></i></a>
      <a href="https://www.twitter.com" target="_blank" rel="noopener noreferrer" style="color:#1DA1F2;"><i class="fab fa-twitter"></i></a>
      <a href="https://www.tiktok.com" target="_blank" rel="noopener noreferrer" style="color:#FE2C55;"><i class="fab fa-tiktok"></i></a>
    </div>
  </div>

  <!-- NEWS -->
  <section class="news" id="news">
    <h2>NEWS <span>ニュース</span></h2>
    <nav class="schedule-filters">
      <button class="active">Todos</button>
      <button>Conciertos</button>
      <button>Lanzamientos</button>
      <button>Eventos</button>
    </nav>
    <div class="schedule-grid" id="news-grid"></div>
  </section>

  <!-- BANNER DISCOGRAPHY -->
  <section class="section-banner" id="banner-discography">
    <div class="banner-content">
      <div class="banner-title">DISCOGRAPHY</div>
      <div class="banner-sub">ディスコグラフィー</div>
    </div>
  </section>

  <!-- DISCOGRAPHY CAROUSEL -->
  <section class="discography" id="discography">
    <div class="container">
      <div class="holder">
        <div class="spinner">
          <!-- 15 paneles en loop -->
          <div class="panel a"></div><div class="panel b"></div><div class="panel c"></div><div class="panel d"></div><div class="panel e"></div>
          <div class="panel a"></div><div class="panel b"></div><div class="panel c"></div><div class="panel d"></div><div class="panel e"></div>
          <div class="panel a"></div><div class="panel b"></div><div class="panel c"></div><div class="panel d"></div><div class="panel e"></div>
          <div class="fade"></div>
        </div>
      </div>
      <div class="pagination">
        <button type="button" id="prev">&#8592;</button>
        <button type="button" id="next">&#8594;</button>
      </div>
    </div>
  </section>

  <!-- BANNER VIDEOS -->
  <section class="section-banner" id="banner-videos">
    <div class="banner-content">
      <div class="banner-title">VIDEOS</div>
      <div class="banner-sub">ビデオ</div>
    </div>
  </section>

  <!-- VIDEOS CAROUSEL -->
  <section class="videos" id="videos">
    <div class="container">
      <div class="videos-holder">
        <div class="spinner-videos" id="spinner-videos"></div>
        <div class="videos-pagination">
          <button type="button" id="prev-video">&#8592;</button>
          <button type="button" id="next-video">&#8594;</button>
        </div>
      </div>
    </div>
  </section>

  <footer>
    <div class="social-bar"></div>
    <p>j-tenshiwebcomingsoon</p>
  </footer>

  <!-- jQuery -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

  <!-- Tema y filtros -->
  <script>
    function toggleTheme() {
      document.body.classList.toggle('light-mode');
      localStorage.setItem('theme', document.body.classList.contains('light-mode') ? 'light' : 'dark');
    }
    if (localStorage.getItem('theme') === 'light') {
      document.body.classList.add('light-mode');
    }
    document.addEventListener('DOMContentLoaded', () => {
      document.querySelectorAll('.schedule-filters button').forEach(button => {
        button.addEventListener('click', () => {
          document.querySelectorAll('.schedule-filters button').forEach(b => b.classList.remove('active'));
          button.classList.add('active');
        });
      });
    });
  </script>

  <!-- Carrusel DISCOS -->
  <script>
    var ang = 0, panels = 15, ang_unit = 360 / panels;
    function updateSpinner() {
      $("*").css("--ang", ang);
      $(".panel").each(function(index) {
        var initial_ang = index * ang_unit;
        var total_ang = (initial_ang + ang) % 360;
        if (total_ang > 180) total_ang -= 360;
        if (total_ang < -180) total_ang += 360;

        if (total_ang > -60 && total_ang < 60) {
          $(this).css({opacity:1, "pointer-events":"auto"});
        } else {
          $(this).css({opacity:0, "pointer-events":"none"});
        }
        if (Math.abs(total_ang) < ang_unit / 2) {
          $(this).css("transform", `rotateY(${index * ang_unit}deg) translateZ(400px) scale(1.4)`);
        } else {
          $(this).css("transform", `rotateY(${index * ang_unit}deg) translateZ(400px) scale(1)`);
        }
      });
    }
    $("#prev").on("click", function(){ ang += ang_unit; updateSpinner(); });
    $("#next").on("click", function(){ ang -= ang_unit; updateSpinner(); });
    $(document).ready(function(){ updateSpinner(); });
  </script>

  <!-- Carrusel VIDEOS -->
  <script>
    var angVid = 0, panelsVid = 9, angVid_unit = 360 / panelsVid;
    function updateSpinnerVideos() {
      $("*").css("--angVid", angVid);
      $(".spinner-videos .video-panel").each(function(index) {
        var initial_ang = index * angVid_unit;
        var total_ang = (initial_ang + angVid) % 360;
        if (total_ang > 180) total_ang -= 360;
        if (total_ang < -180) total_ang += 360;

        if (total_ang > -70 && total_ang < 70) {
          $(this).css({opacity:1, "pointer-events":"auto"});
        } else {
          $(this).css({opacity:0, "pointer-events":"none"});
        }
        if (Math.abs(total_ang) < angVid_unit / 2) {
          $(this).addClass("center");
        } else {
          $(this).removeClass("center");
        }
      });
    }
    $("#prev-video").on("click", function(){ angVid += angVid_unit; updateSpinnerVideos(); });
    $("#next-video").on("click", function(){ angVid -= angVid_unit; updateSpinnerVideos(); });
  </script>

  <!-- Helpers: banners con imagen / video (YouTube limpio o MP4/Drive) + Carga catálogo -->
  <script>
    // --- YouTube helpers ---
    function isYouTube(u){ return /(?:youtube\.com|youtu\.be)/i.test(u || ''); }
    function ytId(u){
      try{
        if(u.includes('youtu.be/')) return u.split('youtu.be/')[1].split(/[?&]/)[0];
        const url = new URL(u);
        if(url.pathname.startsWith('/embed/')) return url.pathname.split('/embed/')[1].split(/[?&]/)[0];
        return url.searchParams.get('v') || '';
      }catch{ return ''; }
    }
    function ytLoopEmbed(u){
      const id = ytId(u);
      if(!id) return null;
      const base = `https://www.youtube-nocookie.com/embed/${id}`;
      const params = [
        'autoplay=1','mute=1','controls=0','playsinline=1',
        'rel=0','modestbranding=1','fs=0','iv_load_policy=3',
        'disablekb=1','loop=1',`playlist=${id}`,'cc_load_policy=0'
      ].join('&');
      return `${base}?${params}`;
    }

    // --- Detección de video directo (mp4/webm/ogg o Drive uc=download) ---
    function isDirectVideo(u){
      if(!u) return false;
      const hasExt = /\.(mp4|webm|ogg)(\?.*)?$/i.test(u);
      const driveUc = /https:\/\/drive\.google\.com\/uc\?export=download&id=[A-Za-z0-9_-]+/i.test(u);
      const gurl = /googleusercontent\.com\/.*\.(mp4|webm|ogg)(\?.*)?$/i.test(u);
      return hasExt || driveUc || gurl;
    }

    // Pone imagen o video de fondo en contenedor .hero-bg o .section-banner
    function setBackgroundMedia(container, url){
      if(!container) return;
      container.querySelectorAll('.bg-video, .bg-iframe').forEach(n => n.remove());
      container.style.backgroundImage = ''; container.style.backgroundColor = '#111';

      if(!url || typeof url !== 'string') return;

      if(isYouTube(url)){
        const embed = ytLoopEmbed(url);
        if(embed){
          const ifr = document.createElement('iframe');
          ifr.className = 'bg-iframe';
          ifr.src = embed;
          ifr.allow = 'autoplay; encrypted-media; fullscreen; picture-in-picture';
          ifr.setAttribute('allowfullscreen','');
          container.appendChild(ifr);
          return;
        }
      }

      if(isDirectVideo(url)){
        const vid = document.createElement('video');
        vid.className = 'bg-video';
        vid.src = url; vid.autoplay = true; vid.muted = true; vid.loop = true; vid.playsInline = true;
        vid.setAttribute('preload','metadata');
        container.appendChild(vid);
        return;
      }

      // Imagen fallback
      container.style.backgroundImage = `url('${url}')`;
      container.style.backgroundSize = 'cover';
      container.style.backgroundPosition = 'center';
      container.style.backgroundRepeat = 'no-repeat';
    }

    // === ENLACES A SECCIONES ===
    const SECTION_MAP = {
      discografia: 'Discography.html',
      movie:       'movie.html',
      news:        'https://jtenshix.github.io/J-tenshi-music/news.html',
      gallery:     'https://jtenshix.github.io/J-tenshi-music/wallpapers.html'
    };
    function resolveDestino(nota) {
      if (nota && typeof nota.link === 'string' && nota.link.trim()) return nota.link.trim();
      if (nota && typeof nota.destino === 'string' && nota.destino.trim()) {
        const key = nota.destino.trim().toLowerCase();
        if (SECTION_MAP[key]) return SECTION_MAP[key];
        if (key.startsWith('#') || key.startsWith('/') || key.includes('.html') || key.startsWith('http')) return key;
      }
      return '#';
    }

    // === Cargar catálogo JSON ===
    async function cargarCatalogoPrincipal() {
      try {
        const resp = await fetch('data/catalogo.json', { cache: 'no-store' });
        const data = await resp.json();

        // HERO
        const hero = document.getElementById('hero-bg');
        if (hero && data.banner_principal) setBackgroundMedia(hero, data.banner_principal);

        // BANNERS
        const bannerDisc = document.getElementById('banner-discography');
        if (bannerDisc && data.banner_discografia) setBackgroundMedia(bannerDisc, data.banner_discografia);

        const bannerVideos = document.getElementById('banner-videos');
        if (bannerVideos && data.banner_videos) setBackgroundMedia(bannerVideos, data.banner_videos);

        // NEWS
        const newsGrid = document.getElementById('news-grid');
        if (newsGrid && data.news && typeof data.news === 'object') {
          newsGrid.innerHTML = '';
          const orden = ['n1','n2','n3','n4','n5'];
          const notas = orden.map(k => data.news[k]).filter(n => n && typeof n.imagen === 'string' && n.imagen.trim());
          notas.forEach((nota, idx) => {
            const a = document.createElement('a');
            a.href = resolveDestino(nota); a.target = '_self';
            a.className = idx === 0 ? 'main-news' : 'news-card';
            a.setAttribute('aria-label', `Abrir: ${nota?.titulo || nota?.destino || 'noticia'}`);
            a.innerHTML = `<img src="${nota.imagen}" alt="${nota?.titulo || 'Noticia'}">`;
            newsGrid.appendChild(a);
          });
        }

        // VIDEOS (hasta 6 del JSON, repetidos hasta 9)
        const spinner = document.getElementById('spinner-videos');
        if (spinner && Array.isArray(data.videos) && data.videos.length) {
          spinner.innerHTML = '';
          const toEmbed = (url) =>
            typeof url === 'string'
              ? url.replace('watch?v=', 'embed/').replace('youtu.be/', 'www.youtube.com/embed/')
              : '';
          const base = data.videos.map(v => toEmbed(v.url)).filter(Boolean).slice(0, 6);
          const lista = []; while (lista.length < 9 && base.length) lista.push(...base);
          const lista9 = lista.slice(0, 9);
          lista9.forEach(u => {
            const panel = document.createElement('div');
            panel.className = 'video-panel';
            panel.innerHTML = `<iframe src="${u}" allowfullscreen></iframe>`;
            spinner.appendChild(panel);
          });
          updateSpinnerVideos();
        }

        // DISCOGRAFÍA (cubre 5 clases a/b/c/d/e)
        if (data.discografia && Array.isArray(data.discografia.portadas)) {
          const covers = data.discografia.portadas.slice(0, 5);
          ['a','b','c','d','e'].forEach((cls, i) => {
            const url = covers[i]; if (!url) return;
            document.querySelectorAll('.discography .panel.' + cls).forEach(el => {
              el.style.backgroundImage = `url('${url}')`;
            });
          });
        }

      } catch (e) {
        console.error('Error cargando catálogo:', e);
      }
    }

    document.addEventListener('DOMContentLoaded', () => {
      cargarCatalogoPrincipal();
      updateSpinnerVideos();
    });
  </script>
</body>
</html>
