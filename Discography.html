<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Tenshi | Discography</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --ink:#111;
      --sub:#666;
      --mut:#9aa0a6;
      --bg:#fff;
      --card:#f7f8fa;
      --bd:#e8eaed;
      --accent:#111;
    }
    *{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%}
    body{
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", sans-serif;
      background: var(--bg);
      color: var(--ink);
    }

    /* Hero */
    .hero{
      position: relative;
      height: 44vh;
      min-height: 260px;
      display: grid;
      place-items: center;
      overflow: hidden;
      border-bottom: 1px solid var(--bd);
    }
    .hero::before{
      content:"";
      position:absolute; inset:0;
      background: #0b0b0b;
      background-size: cover; background-position: center; background-repeat:no-repeat;
      filter: blur(2px) saturate(1.05);
      transform: scale(1.02);
    }
    .hero::after{
      content:"";
      position:absolute; inset:0;
      background: linear-gradient(to bottom, #00000066 0%, #00000055 30%, #00000033 60%, #0000 100%);
    }
    .hero-inner{
      position:relative; z-index:1;
      text-align:center; color:#fff; padding: 0 16px;
    }
    .title{
      font-size: clamp(28px, 4vw, 40px);
      font-weight: 800;
      letter-spacing: .02em;
    }
    .subtitle{
      margin-top:6px;
      font-size: 12px;
      letter-spacing: .3em;
      opacity:.85;
    }

    /* Contenido */
    .wrap{max-width:1080px; margin: 40px auto 70px; padding: 0 18px;}
    .tabs{
      display:flex; gap:10px; justify-content:center; margin-bottom:26px;
    }
    .tab{
      font-size:12px; color:var(--sub);
      padding:6px 10px; border:1px solid var(--bd); border-radius:999px;
      background:#fff; cursor:default; user-select:none;
    }

    .grid{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 26px;
    }
    @media (max-width: 900px){
      .grid{grid-template-columns: repeat(2, 1fr);}
    }
    @media (max-width: 560px){
      .grid{grid-template-columns: 1fr;}
    }

    .album{
      display:flex; flex-direction:column; align-items:center; gap:10px;
    }
    .cover{
      width: 100%;
      aspect-ratio: 1 / 1;
      border-radius: 10px;
      background: var(--card);
      border: 1px solid var(--bd);
      overflow: hidden;
      position:relative;
      transition: transform .25s ease, box-shadow .25s ease;
    }
    .cover img{
      position:absolute; inset:0;
      width:100%; height:100%; object-fit:cover; display:block;
      transition: transform .4s ease;
    }
    .cover:hover{
      transform: translateY(-2px);
      box-shadow: 0 12px 30px #0000001a, 0 2px 10px #0000000f;
    }
    .cover:hover img{ transform: scale(1.04); }

    .meta{
      text-align:center; width:100%;
    }
    .name{
      font-size: 13px; font-weight: 600; color: var(--ink);
      white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
    }
    .note{
      margin-top:3px; font-size: 11px; color: var(--mut);
    }

    /* Footer mini */
    .foot{
      text-align:center; color:var(--mut); font-size:12px; padding: 50px 0 30px;
    }
    a.back{
      display:inline-block; margin-top:14px; font-size:12px; color:#0b57d0; text-decoration:none;
      border:1px solid #cfe0ff; background:#f6f9ff; padding:6px 10px; border-radius:8px;
    }
  </style>
</head>
<body>

  <!-- HERO con el banner de discografía desde catalogo.json -->
  <header class="hero" id="hero">
    <div class="hero-inner">
      <h1 class="title">DISCOGRAPHY</h1>
      <div class="subtitle">ディスコグラフィー</div>
    </div>
  </header>

  <main class="wrap">
    <nav class="tabs">
      <span class="tab">All</span>
      <span class="tab">Singles</span>
      <span class="tab">Albums</span>
      <span class="tab">Collabs</span>
    </nav>

    <!-- Grilla -->
    <section class="grid" id="discography-grid">
      <!-- Se llena por JS con discografia.portadas -->
    </section>

    <div class="foot">
      Rendered from <code>data/catalogo.json</code><br>
      <a class="back" href="index.html">← Volver</a>
    </div>
  </main>

  <script>
    async function loadDiscography(){
      try{
        const resp = await fetch('data/catalogo.json', {cache:'no-store'});
        const data = await resp.json();

        // HERO banner (usa banner_discografia si existe, si no banner_principal)
        const hero = document.getElementById('hero');
        const banner = data.banner_discografia || data.banner_principal;
        if (hero && banner){
          hero.style.setProperty('--bg-img', `url('${banner}')`);
          hero.style.background = 'transparent';
          hero.style.setProperty('--banner', `url('${banner}')`);
          hero.style.backgroundImage = `url('${banner}')`; // fallback
        }
        // Usamos ::before del .hero para el fondo real (ya definido en CSS con background setFromJS)
        // Sobrescribimos la pseudo con style directo:
        // (Truco: creamos una hoja de estilo dinámica)
        if (banner){
          const css = `.hero::before{ background-image:url('${banner}'); }`;
          const style = document.createElement('style');
          style.textContent = css;
          document.head.appendChild(style);
        }

        // DISCOS: usa las mismas imágenes que tu carrusel (discografia.portadas)
        const grid = document.getElementById('discography-grid');
        grid.innerHTML = '';

        const covers = (data.discografia && Array.isArray(data.discografia.portadas))
          ? data.discografia.portadas
          : [];

        covers.forEach((url, idx) => {
          const card = document.createElement('article');
          card.className = 'album';
          card.innerHTML = `
            <div class="cover">
              <img src="${url}" alt="Cover ${idx+1}" loading="lazy">
            </div>
            <div class="meta">
              <div class="name">Track #${idx+1}</div>
              <div class="note">Single / EP</div>
            </div>
          `;
          grid.appendChild(card);
        });

        // Si quieres repetir para llenar más filas (opcional):
        // while (grid.children.length < 9) { covers.forEach((url, i)=>{ ... }); }

      }catch(e){
        console.error('Error cargando catalogo.json', e);
      }
    }
    document.addEventListener('DOMContentLoaded', loadDiscography);
  </script>
</body>
</html>
