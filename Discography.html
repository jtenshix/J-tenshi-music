<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Tenshi | 幻想の響き</title>
<style>
  *{margin:0;padding:0;box-sizing:border-box;}
  body{font-family:'Helvetica Neue',sans-serif;background:#0b0b0b;color:#f5f5f5;}
  header{position:fixed;top:0;width:100%;background:rgba(0,0,0,0.8);padding:20px 5%;display:flex;justify-content:space-between;align-items:center;z-index:999;}
  header .logo{color:#fff;font-size:20px;}
  nav ul{display:flex;gap:25px;list-style:none;}
  nav a{text-decoration:none;color:#ccc;font-size:14px;}
  nav a:hover{color:#e0c27b;}
  .theme-toggle{background:none;border:1px solid #777;color:#ccc;padding:6px 12px;border-radius:8px;cursor:pointer;font-size:12px;}
  .hero-wrapper{position:relative;height:50vh;overflow:hidden;margin-top:70px;}
  .hero-bg{position:absolute;top:0;left:0;width:100%;height:50vh;background:url('banner portada.png') center/cover no-repeat;z-index:0;}
  .hero-text{position:relative;z-index:2;color:white;font-size:2rem;padding:60px 5%;height:50vh;display:flex;align-items:center;text-shadow:0 2px 10px rgba(0,0,0,0.6);}
  .section-banner{position:relative;width:90%;max-width:1800px;margin:60px auto;padding:20px;text-align:center;color:#e0c27b;font-size:2rem;font-weight:900;}
  .audio-player-list{display:flex;flex-direction:column;gap:20px;max-width:900px;margin:40px auto;}
  .audio-card{display:flex;align-items:center;background:#222;padding:12px 20px;border-radius:12px;gap:15px;}
  .audio-card img{width:80px;height:80px;object-fit:cover;border-radius:8px;}
  .audio-info{flex:1;}
  .audio-info h4{margin-bottom:6px;font-size:16px;}
  .audio-info span{font-size:12px;color:#e0c27b;}
  .play-btn{padding:8px 12px;border:none;border-radius:8px;background:#e0c27b;color:#000;cursor:pointer;font-weight:bold;}
  .progress-bar{width:100%;height:4px;background:#555;border-radius:4px;overflow:hidden;margin-top:6px;}
  .progress{width:0%;height:100%;background:#e0c27b;transition:width 0.2s;}
</style>
</head>
<body>

<header>
  <div class="logo">Tenshi</div>
  <nav>
    <ul>
      <li><a href="#news">News</a></li>
      <li><a href="#discography">Discography</a></li>
      <li><a href="#videos">Videos</a></li>
    </ul>
  </nav>
  <button class="theme-toggle" onclick="toggleTheme()">Modo Claro / Oscuro</button>
</header>

<div class="hero-wrapper">
  <div class="hero-bg"></div>
  <div class="hero-text">Bienvenido a Tenshi | 幻想の響き</div>
</div>

<div class="section-banner">ディスコグラフィー</div>
<section id="discography">
  <div class="audio-player-list" id="audio-player-list"></div>
</section>

<script src="https://www.youtube.com/iframe_api"></script>
<script>
const API_KEY = 'TU_CLAVE_DE_API';
const PLAYLIST_ID = 'PLkcZMdABSTfhe26NpsiFJev_0lCOcfCCf';
let players = {};
let currentPlaying = null;

function toggleTheme() {
  document.body.classList.toggle('light-mode');
}

// Trae videos de la playlist
async function fetchPlaylistVideos() {
  try {
    const res = await fetch(`https://www.googleapis.com/youtube/v3/playlistItems?part=snippet&playlistId=${PLAYLIST_ID}&key=${API_KEY}&maxResults=50`);
    if(!res.ok) throw new Error('Error al obtener videos de YouTube');
    const data = await res.json();
    return data.items || [];
  } catch(e) {
    console.error(e);
    return [];
  }
}

// Renderiza los tracks
function renderAudioPlayers(videos) {
  const list = document.getElementById('audio-player-list');
  list.innerHTML = '';
  videos.forEach((item, index) => {
    const video = item.snippet;
    const videoId = video.resourceId.videoId;
    const title = video.title || 'Track ' + (index + 1);
    const thumbnail = (video.thumbnails && (video.thumbnails.high || video.thumbnails.medium || video.thumbnails.default)).url;
    
    const card = document.createElement('div');
    card.className = 'audio-card';
    card.innerHTML = `
      <img src="${thumbnail}" alt="${title}">
      <div class="audio-info">
        <h4>${title}</h4>
        <span>Track ${index+1}</span>
        <div class="progress-bar"><div class="progress"></div></div>
      </div>
      <button class="play-btn">▶️</button>
      <div id="player-${videoId}" style="display:none;"></div>
    `;
    list.appendChild(card);

    // Crea reproductor oculto
    players[videoId] = new YT.Player(`player-${videoId}`, {
      height: '0',
      width: '0',
      videoId,
      events: { 'onStateChange': (e)=>updateProgress(videoId) }
    });

    const btn = card.querySelector('.play-btn');
    const progressEl = card.querySelector('.progress');

    btn.addEventListener('click', () => {
      if(currentPlaying && currentPlaying !== videoId) {
        players[currentPlaying].pauseVideo();
        document.querySelector(`#player-${currentPlaying}`).closest('.audio-card').querySelector('.play-btn').textContent = '▶️';
      }
      if(players[videoId].getPlayerState() !== 1) {
        players[videoId].playVideo();
        btn.textContent = '⏸️';
        currentPlaying = videoId;
      } else {
        players[videoId].pauseVideo();
        btn.textContent = '▶️';
        currentPlaying = null;
      }
    });

    function updateProgress(id) {
      const player = players[id];
      const progress = card.querySelector('.progress');
      if(player.getPlayerState() === YT.PlayerState.PLAYING) {
        const interval = setInterval(()=>{
          const dur = player.getDuration();
          const cur = player.getCurrentTime();
          if(dur>0) progress.style.width = (cur/dur*100)+'%';
          if(player.getPlayerState() !== 1) clearInterval(interval);
        },200);
      }
    }
  });
}

function onYouTubeIframeAPIReady() {
  fetchPlaylistVideos().then(videos => renderAudioPlayers(videos));
}
</script>

</body>
</html>
